# Math Basic Notes

## 牌效策略

基于 **向听数** 与 **进张数**, 适当考虑 **高番数**:

- 摸入后可以减少向听数的牌称为**进张**.
- 摸入后可以增加进张数的牌称为**改良**.
- **进张**与**改良**合称为**有效牌**.

### 单张牌效

切牌顺序:

- 客风牌 / (**`1`** 4, 6 **`9`**).
- `1` `9`: 孤立的老头牌比任何一种对子和搭子的价值都要低.
- 役牌.
- `2` `8`.
- `3` `4` `5` `6` `7`.

### 对子牌效

- 两对子双碰: 两对子存在双碰进张.
- 三对子不利: 相比于两对子, 仅增加 2 张刻子进张.
  - 常常考虑切掉 1 对子, 并保证向听数不减少: 切两面对 -> 切嵌张对 -> 切边张对.
  - 有役时 (如役牌或对对和), 可将**碰**作为进张手段.
- 四对子: 可考虑七对子役种.

### 搭子牌效

- 搭子: 两面 > 连嵌 > 嵌张 > 边张.
- **五块理论**: 五搭子饱和, 六搭子不利.
- 五搭子形基本上只要切掉价值最低的浮牌.
- `1x4` / `6x9`:
  - 有效牌重复效应: `147`, `258`, `369` 同一筋上存在有效牌重复效应.
  - 边张有效牌重复: `14` / `69` 存在时, `1` `9` 价值甚至低于客风牌.
  - `14` 进 `2`/`3`, 形成 `124`/`134`, 仍然切 `1`, 所以可以在 `14` 时就切 `1`.
- 存在二度进张的边张搭子, 切掉边张搭子保留浮牌比较有利.
- 搭子超载时, 优先切掉弱搭子:
  - **低效率二度进张**: 考虑有效牌重复效应, 可以切掉同色超载搭子 (进张数损失最小).
  - 存在复合型时, 可以先切边张: 价值低.
  - 不存在复合型时, 可以先切中张: 危险度高.
- 双碰进张优于连嵌进张, 特别是在有役牌时, **碰**的几率远大于**吃**.
- **高向听**时, 禁止切掉唯一一组雀头 (切掉后会导致向听数减小).

### 三牌复合型

- 两面对: `233`.
- 嵌张对: `244`.
- 边张对: `122`.
- 连嵌张: `246`.
  - 两面嵌张: `2` + `456` + `67` -> `246` + `567`.
  - 长连嵌张: `134568`, 进 `2` 或 `7` 都可形成两面子.
  - 弱于两面搭子: 需要 3 张牌, 听牌型为嵌张听.

搭子进张成为搭子 + 对子复合型, 称该进张为**补强牌**:

- 两对子双碰:
  当出现两组复合型二择时,
  切掉搭子部位较弱的复合型的**搭子**,
  固定两对子双碰牌型.
- 三对子不利:
  当出现三对子不利时,
  切掉搭子部位较强的复合型的**对子** (如两面对),
  **让补强牌辅助较弱的搭子**,
  固定强搭子牌型 (复合型 - 对子 = 搭子),
  即**固定好型**,
  切掉三对子不利牌型.
- 固定好型的方法还可以将复合型的数量考虑进去:
  `335577` 中,
  `335` 是一个嵌张对,
  `355` + `557` 是两个嵌张对,
  `577` 是一个嵌张对,
  一般选择切 `5`, 固定中间连嵌好型.

`13345667m` + `123788s`:

先根据五块理论与中膨复合型, 将手牌分为 `133m` + `456m` + `67m` + `123s` + `788s`.
可以此时已经形成了有效的五块搭子, 需要切掉两个三牌复合型中的一个, 保持张数的正收益.
对于`对子` + `搭子`的复合型, 可以采取固定好型的策略, 切掉 `8s`, 固定 `78s` 两面型.
显然切掉 `3m` 去固定 `13m` 嵌张型是低效率的切法.

### 四牌复合型

- 四连型 (延伸单骑):
  - 良型: `3456` -> `34` + `56`, 常常将其视为**两面 + 两面**, 而不是单骑进张.
  - 次良型: `1234` -> `123` + `4`, 常常将其视为单骑进张, 而不是**边张 + 两面**.
  - 缺少对子时, 四连型的延伸单骑价值上升; 不缺对子时, 四连型的延伸单骑价值下降.
- 中膨型:
  - 良型: `3445` -> `34` + `45`, 两面 + 一杯口.
  - **恶型**: `1223` -> `123` + `2`, 价值较低, 接近于单张 `2`, 可优先切掉 `2`, 保留其他单张 (如 `4`, `7`).
- 亚两面型:
  - `3345` -> `33` + `45` 对子 + 两面.
  - `1233` (对子 + 边张) 不是亚两面型.
  - `1123` (对子 + 两面) 是亚两面型.
  - 缺少对子时, `3345` 有一定价值, 稍稍高于单张 `3`.
  - 不缺对子时, `3345` 价值较低, 接近于单张 `3`, 可优先切掉 `3`, 保留其他复合型.
  - `1123` 价值接近于单张 `1`, `7899` 价值接近于单张 `9`.
  - 总体来说, 亚两面型作两面能力与孤张无太大区别.
  - `3345` -> `35` + `34`, 可以通过鸣牌改良成 `34` 两面.
  - 亚两面型可以直接用于听牌, 存在转二杯口可能性, 可以形成 `33345` 暗刻复合型.
- 跳一型:
  - `1235`/`5789` 接近于孤张 `5`.
  - `1345`/`5679` 中的 `1`/`9` 比孤张 `1`/`2`/`8`/`9` 强.
  - `3457` 可以形成良型 `34567`, 利用**吃**可以形成两面子.
- 二度进张愚型:
  - `3344`.
  - `5778`.
- 强度: 四连型 > 中膨型 >> 亚两面型.

`1234p` 与 `1123s`:

当手牌缺少对子时, 四连型中的 `1p` 可以解放 `4p`, 进张下一个 `4p` 时, 可以形成面子 + 雀头,
即 `1p` + `234p` -> `123p` + `4p`, 使得 `1p` 价值约等于 `4p`.

而亚两面型中的 `1s` + `123s` 却无法解放 `3s`, 使得 `1s` 价值约等于 `1s`.
比较 `4p` 与 `1s` 价值, 可以得出此时应该切 `1s`, 保留 `1p`.

### 多张复合型

- 暗刻复合型: `333` + `45` -> `33` + `345`, 缺少对子时, 价值上升.
- `23578` 切 5.
- `34455`: `345` + `45`.
- `344556`: `345` + `456`.
- `2267888`: `22` + `88` + `678` / `67` + `22` + `888`.

## 向听策略

### 两向听策略

- `面子` + `雀头` + 3 `搭子`: 优先切掉低价值浮牌.
- `面子` + 4 `搭子`:

### 一向听策略

- 接近听牌时 (不再缺少搭子),
  可考虑切掉四牌复合型 (四张牌挤占空间) 退回面子 (固定好型),
  保留三牌复合型 (两面对/嵌张对/连嵌张),
  固定 `搭子` + `搭子` 型,
  可以提升直接进张数量.
- 可以考虑高番数减低向听数:
  - 断平和: 切边张搭子.
  - 混一色/清一色: 切同色搭子 (甚至面子)
- `暗刻` + `面子` + `两搭子` 低向听, 不固定雀头进张数更多.
- 完全一向听:
  - 面子 + 面子 + 对子 + 两面 + 两面对.
- 撞头一向听:
  - 3 面子 + 1 雀头 + 2 单张.
  - 质量较高的一向听, 单张与面子形成复合型后会进一步提升进张数量.

### 听牌策略

- 两面听: `23` 听 `1` `4`.
- 双碰听: `22` `55` 听 `2` `5`.
- 嵌张听: `24` 听 `3`.
- 边张听: `12` 听 `3`, `89` 听 `7`.
- 单骑听
  - 雀头.
  - 和牌率: 熟张字牌 > 幺九牌 > (外) 壁引卦 > (边) 筋引卦.
- 听牌数: 两面听 > 双碰听 > 嵌张听 > 边张听 > 单骑听.
  - 两面听优势明显, 听牌数为 8.
  - 单骑听变化多, 难以防守, 特别是听熟张字牌容易荣和.
- 四连型与亚两面型听牌数都为 6.
- 暗刻复合型:
  - `1222`: 边张单骑, `1` + `222` / `12` + `22`, 听牌数为 7.
  - `3555`: 嵌张单骑, `3` + `555` / `35` + `55`, 听牌数为 7.
  - `3444`: 两面单骑, `3` + `444` / `34` + `44`, 听牌数为 11.
- 三面听:
  - 听三种牌.
  - 基本三面听: `34567` -> `34` + `567` / `345` + `67`, 听牌数为 11.
  - 单骑三面听: `1234567`, `2234567`, `4566789`, 听牌数为 9.
  - 混合三面听: `23445566`, 可以形成一杯口.
  - 多面听时, 三暗刻也可看作`雀头`+`单张`.
- 满贯以下听高点, 满贯以上听张数.

### 鸣牌策略

- 鸣牌是赤牌麻将中非常重要的技术.
- 鸣牌优点: **速度上升**.
- 鸣牌的缺点: **打点下降**, **防御力下降**.

#### 鸣牌选择

- 两张以上宝牌时候要重视速度与和牌的容易度,
  把鸣牌作为做牌的前提.
- 亲家速攻: 鸣牌提升和牌速度, 保持连庄.
- 可以考虑鸣牌:
  - 满贯手牌.
  - 孤张进张.
  - 消除愚型.
  - 宝牌.
  - 两副露: 一向听, 两向听好型, 打点 3900 以上.
  - 三副露: 听牌, 一向听满贯手役.
- 不建议鸣牌:
  - 牌型差, 打点低. 鸣牌对于速度增益小, 不鸣牌可保持高打点和防御力.
  - 向听数不变且没有改良.
  - 鸣牌**过早**或鸣牌**过多**都会导致他家提高警惕性, 使得和牌可能性变小.

#### 吃牌策略

- 吃牌时尽量选择嵌张/边张吃, 进张数最大化.

#### 杠牌策略

- 幺九牌暗杠 32 符, 相当于 1 番.
- 杠宝牌/岭上开花增强手牌番数.
- 杠牌增加一次摸切机会.
- 不建议杠牌:
  - 牌型差.
  - 进张减少.
  - 他人立直.

## 手役策略

### 常见役种

- 一番役:
  - 立直: **(门清)** 报听.
  - 役牌: `场风牌`/`自风牌`/`三元牌` 刻子或杠子.
  - 平和: **(门清)** 四顺子 + 两面听 + 非役牌雀头.
  - 断幺九: 二八数牌.
  - 一杯口: **(门清)** 两相同顺子.
- 二番役:
  - 三色同顺: **(降番)** 三组数字相同, 花色不同的顺子.
  - 七对子 (七对): **(门清)** 不可有相同对子.
  - 对对和 (对对). 四面子都是刻子或杠子.
  - 一气贯通 (一通): **(降番)** 1-9 同色顺子.
  - 三暗刻: 手牌有三暗刻或暗杠.
- 三番役:
  - 混一色 (混一): **(降番)** 所有元素由同一种花色和字牌构成.
- 六番役:
  - 清一色 (清一): **(降番)** 所有元素由同一种花色构成.

| Rank | Type     | Ratio (%) |
| ---- | -------- | --------- |
| A    | 立直     | 42.6      |
| A    | 役牌     | 38.7      |
| A    | 平和     | 22.5      |
| A    | 断幺九   | 21.2      |
| B    | 混一色   | 6.1       |
| B    | 一杯口   | 5.0       |
| B    | 三色同顺 | 4.3       |
| B    | 七对子   | 3.0       |
| B    | 对对和   | 2.9       |
| C    | 一气贯通 | 1.7       |
| C    | 全带幺   | 1.2       |
| C    | 三暗刻   | 0.8       |
| C    | 清一色   | 0.8       |
| F    | 其他     | < 0.5     |

- 配合自己的摸牌来作手役是一个准则, 禁止刻意作大牌 (强行拆掉多个搭子).
- `有手役` = `能够鸣牌` = `速度快`, 手役用来提高速度是现代麻将的一种思想.
- 打点 (番数) 相同时, 确定的手役比不确定的手役更有利:
  - 断幺九接近成型, 可以选择切掉役牌对子 (未成型), 保留其他中张的对子或搭子, 选择断幺九手役.
  - 断幺九并未确定, 可以选择保留役牌对子, 切掉其他超载的对子或搭子, 选择役牌手役.
- 手役会限制牌形 (防守 ↓), 作手役切牌大概率不是进张数最大化的切牌 (速度 ↓), 是其不可忽视的两大缺点.
- 混全带, 纯全带, 混老头等手役在赤牌麻雀中收益不高.
- 低打点时, 不应盲目和亲家对和 (放铳代价很大).
- 领先时, 速攻 (役牌, 立直) 抢庄时保持一位的有效手段.

### 平和手役

- 作两面是作平和手役的要点.
- 切掉役牌雀头, 保持断幺平和的可能.

### 断幺九手役

- 断幺九**可鸣牌 + 赤宝牌**可以做到速攻多番.
- 断幺九容易作成, 容易与其他役复合, 摸切过程中需要考虑断幺九可能性.

### 染手手役

- 具有断幺/三色/一气贯通等其他可能手役时, 不要强去染手.
- 10 张以上同色牌可以考虑染手手役.
- 存在两个役牌对子时, 作染手手役可达成满贯.
- 牌型较差的混一色要重视防守 (先打中张给对手读牌压力),
  高向听时不要轻易鸣牌.

### 三色同顺手役

- 在不损失牌效时, 可以考虑三色同顺手役.

### 对对和手役

- 中晚巡时, 七对子听牌后, 禁止转成对对和.
- 幺九牌容易鸣牌, 中张数牌不容易鸣牌.
- 可以考虑对对和手役:
  - 5 组 `刻子` 或 `对子`.
  - 早巡多对幺九对子 + 3900 打点.

### 立直手役

- 立直和默听打点界限为**满贯**.
- 跳满以上, 一律默听.
- 满贯确定, 基本上都是默听.
- AL + TOP + 役牌, 选择默听.
- 低打点时, 默听可以有改良与弃和机会.
- `无役`有`宝牌`和`赤牌`的愚型听牌立直是上等选择.
- 好型 + 早巡时, 立直更有利.
- 四暗刻立直, 逼迫对手防守, 延长巡目, 提高自摸可能性.
- 追立时应优先听张数, 一定程度上放弃高打点.

## 振听规则

处在振听状态下, 无法荣和, 只能自摸.

### 捨牌振听

- 曾打出过当前听牌 (胡牌型, 不考虑役种), 进入捨牌振听, 所有听牌都无法荣和, 只能自摸.
- 解除方法: 换听其他没有振听的牌.
- 意味着可以**安全打出**其他三家**河牌与副露**,
  通过看牌避免放铳, 强调立直麻将的防守性.

### 同巡振听

- 听牌时, 没有荣和他人的牌, 进入同巡振听.
- 解除方法: 下一次自己打出任何牌.
- 意味着在一巡中可以**安全打出**上家打出过的牌,
  通过看牌避免放铳, 强调立直麻将的防守性.

### 立直振听

- 立直听牌时, 若出现可以胡的牌, 但没有进行胡牌, 进入立直后振听.
- 一直持续到此局结束, 意味着此局只能自摸.

:::tip 竞技麻将
振听规则是奠定立直麻将防守战术的基石.
:::

## 防守策略

### 安全牌

- 三家现物.
- 熟张字牌.
- 完全 NO CHANCE 牌.

### 壁牌

- 壁牌: 四枚可见, 对应 NO CHANCE 牌.
- 薄壁牌: 三枚可见, 对应 ONE CHANCE 牌.
- 壁牌/薄壁牌外侧牌相对安全, 内侧牌仍有放铳可能.

### 筋牌

表筋 `147`, `258`, `369`:

- 满筋 (**安全**): 现物有 `1` `7`, 则 `4` 是满筋牌.
- 边筋 (**安全**): 现物有 `4` `6`, 则 `1` `9` 是边筋牌.
- 半筋: 现物只有 `1`, 则 `4` 是半筋牌, 不太安全 (e.g `156` 切 `1` 听 `47`).

里筋 (**危险**):

- X < 5, X 里筋 = `X+1` 和 `X+4`
- X = 5, X 里筋 = `X-4`, `X-1`, `X+1`, `X+4`.
- X > 5, X 里筋 = `X-1` 和 `X-4`.
- 里筋自身互为筋牌 (差 3).

跨筋/周边 (**危险**):

- `X-2`.
- `X-1`.
- `X+1`.
- `X+2`.

### 早巡外侧

- 早巡手切边张, 外侧牌安全.

### 弃和

安全度:

- 现物 > 熟字.
- NO CHANCE 外侧 > 双重 ONE CHANCE 外侧 > ONE CHANCE 外侧.
- 边筋 > 满筋 > 早巡 (筋/壁) 外侧.
- 边张 > 生张 > 宝牌生张.

配牌弃和:

配牌极差, 没有和牌可能.
可以优先切中张,
即可切掉危险牌保留安全牌,
又可制造混一色/国士无双假象.

### 兜牌

保留危险张的同时, 向听牌前进:

- 拆对子.
- 拆搭子.
- 拆暗刻.
- 七对子: 最强防守牌型, 又有和牌可能.

### 副露读牌

- 三副露: 听牌.
- 染手手役打出第一张同色牌, 听牌, 一向听.
- 连续摸切: 低向听.
- 宝牌副露: 防止放铳, 不应盲目对和.
- 断幺九副露: 不应直接弃和.

### 立直读牌

立直读牌策略:

- 跨筋: **晚巡**手切 `5`, `5` 跨筋危险度提升.
- 里筋: **早巡**手切 `5`, `5` 里筋危险度提升.
- 双里筋 (间四间防守):
  **早巡**手切 A 和 B, `A + 5 = B`, A 和 B 的里筋 (**相同**) 非常危险.

### 攻守选择

- 和牌容易度.
- 打点.
- 牌的危险度.
- 弃和成功率.
- 听牌攻, 一向听攻一巡, 两向听以下弃和.

## Mahjong Reference

- [Beginner's Luck](http://beginners.biz/kihon)
- [魔女ブログ](https://puyokururu.medium.com)
- [おしえて！科学する麻雀](https://book.douban.com/subject/20390543)
- [Li, Junjie, et al. "Suphx: Mastering mahjong with deep reinforcement learning." arXiv preprint arXiv:2003.13590 (2020)](https://arxiv.org/pdf/2003.13590.pdf)
