# Vim Basic Notes

## Normal模式命令

### 重复命令

#### . 

*微型宏*: 重复上一次(插入命令 至 <Esc>)录制动作

#### ;

重复t/T/f/F

#### @:

重复任意Ex命令

#### :&

重复:substitute

------

### 撤销命令

|目的|操作|重复|回退|
|:------------------------------:|:---------------:|:-----:|:-----:|
|做出一个修改|{edit}|.|u|
|在行内查找下一指定字符|f{char}/t{char}|;|,|
|在行内查找上一指定字符|F{char}/T{char}|;|,|
|在文档中查找下一处匹配项|/pattern<CR>|n|N|
|在文档中查找上一处匹配项|?pattern<CR>|n|N|
|执行替换|:s/target/replacement|&|u|
|执行一系列修改|qx{changes}q|@x|u|

------

### 复合命令

#### 插入

|复合命令|等效的长命令|
|:--------:|:-------------:|
|C|c$|
|s|cl|
|S|^c|
|I|^i|
|A|$a|
|o|A<CR>|
|O|ko|

------

### 编辑命令

#### Operator + {motion} 精神

操作符命令 + 动作命令(范围)

>:h operator
:h :map-operator

*操作符命令*: 基本编辑命令

|命令|用途|
|:-----:|:--------------------:|
|c|修改|
|d|删除|
|y|复制到寄存器|
|g~|反转大小写|
|gu|转换为小写|
|gU|转换为大写|
|>|增加缩进|
|<|减小缩进|
|=|自动缩进|
|!|使用外部程序过滤{motion}所跨越的行|

*动作命令* 

> e.g 2l/aw/ap 或 /patterns

-   模式串: /patterns
-   文本对象: i/a

> 分隔符文本对象

|分隔符文本对象|选择区域|
|:---------:|:--------------------:|
|a) 或ab|一对圆括号(parentheses)|
|i) 或ib|圆括号(parentheses) 内部|
|a} 或aB|一对花括号{braces}|
|i} 或iB|花括号{braces} 内部|
|a]|一对方括号[brackets]|
|i]|方括号[brackets] 内部|
|a>|一对尖括号 <angle brackets>|
|i>|尖括号 <angle brackets> 内部|
|a'|一对单引号'single quotes'|
|i'|单引号'single quotes' 内部|
|a"|一对双引号"double quotes"|
|i"|双引号"double quotes" 内部|
|a\`|一对反引号\`backticks\`|
|i\`|反引号\`backticks\` 内部|
|at|一对XML 标签<xml>tags</xml>|
|it|XML 标签内部|

> 范围文本对象

|范围文本对象|选择范围|
|:---------:|:--------------------:|
|iw|当前单词|
|aw|当前单词及一个空格|
|iW|当前字串|
|aW|当前字串及一个空格|
|is|当前句子|
|as|当前句子及一个空格|
|ip|当前段落|
|ap|当前段落及一个空行|

#### 插入

|复合命令|等效的长命令|
|:--------:|:-------------:|
|C|c$|
|s|cl|
|S|^c|
|I|^i|
|A|$a|
|o|A<CR>|
|O|ko|

#### 删除

##### d{motion}

##### c{motion}

#### 选择

##### *

选中包含光标处字符的单词

#### 跳转

-   基本

|命令|光标动作|
|:-----:|:-------------------------:|
|%|跳转至下一个配对的范围符号|
|j|向下移动一个实际行|
|gj|向下移动一个屏幕行|
|k|向上移动一个实际行|
|gk|向上移动一个屏幕行|
|0|移动到实际行的行首|
|g0|移动到屏幕行的行首|
|^|移动到实际行的第一个非空白字符|
|g^|移动到屏幕行的第一个非空白字符|
|$|移动到实际行的行尾|
|g$|移动到屏幕行的行尾|
|||
|w|正向移动到下一单词的开头|
|b|反向移动到当前单词/上一单词的开头|
|e|正向移动到当前单词/下一单词的结尾|
|ge|反向移动到上一单词的结尾|
|||
|gg|文首|
|G|文尾|

-   标记  m{alpha} 标记当前光标处,标记名为alpha 

|位置标记|跳转到|
|:-----:|:-------------------------:|
|`{alpha}|自定义标记处|
|``|当前文件中上次跳转动作之前的位置|
|`.|上次修改的地方|
|`^|上次插入的地方|
|`[|上次修改或复制的起始位置|
|`]|上次修改或复制的结束位置|
|`<|上次高亮选区的起始位置|
|`>|上次高亮选区的结束位置|

#### 查找

##### 字符

|命令|光标动作|
|:-----:|:-------------------------:|
|w|正向移动到下一单词的开头|
|b|反向移动到当前单词/上一单词的开头|
|e|正向移动到当前单词/下一单词的结尾|
|ge|反向移动到上一单词的结尾|
|;|重复/f/F/t/T|
|,|撤销/f/F/t/T|

##### <C-a>/<C-x>

查找数字,递增/减数字

##### /pattern ?pattern

#### 替换

> :h gU

-   gU{motion} 小写转大写  e.gUaw
-   r{char}  替换光标所在字符
-   gr{char}
-   R/gR     进入替换模式

#### 缩进

##### ={motion}

`gg=G` 自动缩进全文

#### 注释

##### \\{motion} 

> vim-commentary插件

\\\ 注释行
\\ap 注释段落

#### 历史记录

u: 回退命令
<C-r>: 前进命令

## Insert模式命令

### 模式转换

<C-o> - 进入临时normal模式

### 插入

#### 特殊字符

> :h digraphs-default
:h digraph-table
:digraphs

|命令|作用|
|:--------------------:|:------------------------------:|
|<C-v>{123}|以十进制字符编码插入字符|
|<C-v>u{1234}|以十六进制字符编码插入字符|
|<C-v>{nondigit}|按原义插入非数字字符|
|<C-k>{char1}{char2}|插入以二合字母{char1}{char2}表示的字符|

### 删除

|命令|作用|
|:------------:|:--------------------:|
|<C-h>|删除前一个字符(同退格键)|
|<C-w>|删除前一个单词|
|<C-u>|删至行首|

### 粘贴

-   <C-r>{register}      粘贴
-   <C-r><C-p>{register} 智能粘贴


|寄存器|作用|
|:------------:|:--------------------:|
|0|普通寄存器|
|=|算术寄存器: 在下方输入表达式后,自动粘贴运算结果|

------

## 可视模式

|命令|作用|
|:--------:|:--------------------:|
|v|激活面向字符的可视模式|
|V|激活面向行的可视模式|
|<C-v>|激活面向列块的可视模式|
|gv|重选上次的高亮选区|

-   o 切换高亮选区的活动端

## 底行模式

> :h ex-cmd-index

|命令|作用|
|:---------------:|:---------------------------------------------------------:|
|:edit/:write|读写文件|
|:tabnew|创建新标签页|
|:split|分割窗口|
|:prev/:next|前/后标签页|
|:bprev/:bnext|前/后缓冲区列表|
|:copy|命令对快速复制一行非常好用|
|:[range]delete [x]|删除指定范围内的行[到寄存器x 中]|
|:[range]yank [x]|复制指定范围的行[到寄存器x 中]|
|:[line]put [x]|在指定行后粘贴寄存器x 中的内容|
|:[range]copy/t/co{address}|把指定范围内的行拷贝到{address} 所指定的行之下|
|:[range]move/m {address}|把指定范围内的行移动到{address} 所指定的行之下|
|:[range]join|连接指定范围内的行|
|:[range]normal {commands}|对指定范围内的每一行执行普通模式命令{commands}|
|:[range]substitute/{pattern}/{string}/[flags]|把指定范围内出现{pattern}的地方替换为{string}|
|:[range]global/{pattern}/[cmd]|对指定范围内匹配|
|:shell|打开内置shell|
|:!{commands}|执行外部命令|

```shell
cnoremap <expr> %% getcmdtype( ) == ':' ? expand('%:h').'/' : '%%'
```

### 补全

#### 自动补全

<C-d>

#### 粘贴

<C-r><C-w>: 将光标所在单词粘贴至命令行

#### 历史记录

q/ 或 q: 弹出历史记录窗口

### Range

-   {start},{end}
-   number表示行号,`.`表示当前行,`$`表示最后一行,`%`表示所有行
-   `/start_pattern/,/end_pattern/` 

|符号|地址|
|:-----:|:--------------------:|
|1|文件的第一行|
|$|文件的最后一行|
|0|虚拟行,位于文件第一行上方|
|.|光标所在行|
|'m|包含位置标记m 的行|
|'<|高亮选区的起始行|
|'>|高亮选区的结束行|
|%|整个文件(:1,$ 的简写形式)|

> e.g 1   第1行
    %   所有行
    2,$ 第2行 - 最后一行
    /<html>/,/<\/html>/ 标签html所有行

### 撤销/重复

-   @:    重复命令
-   <C-o> 撤销命令

### Shell

|命令|作用|
|:--------------------:|:----------------------:|
|:shell|启动一个shell (输入exit 返回Vim)|
|:!{cmd}|在shell 中执行{cmd}|
|:read !{cmd}|在shell 中执行{cmd} ,并把其标准输出插入到光标下方|
|:[range]write !{cmd}|在shell 中执行{cmd} ,以[range] 作为其标准输入|
|:[range]!{filter}|使用外部程序{filter} 过滤指定的[range]|

## 文件与缓冲区

### 缓冲区

|命令|作用|
|:------------------------:|:------------------:|
|:b{bufferNumber/bufferName}|跳转至指定缓冲区|
|:bd{bufferNumber/bufferName}|删除指定缓冲区|

### 保存文件

|命令|作用|
|:-------------:|:-------------------------------:|
|:w[rite]|把缓冲区内容写入磁盘|
|:e[dit]!|把磁盘文件内容读入缓冲区(即回滚所做修改)|
|:qa[ll]!|关闭所有窗口,摒弃修改而无需警告|
|:wa[ll]!|把所有改变的缓冲区写入磁盘|

### 窗口

-   创建窗口

|命令|作用|
|:-------------:|:-------------------------------:|
|<C-w>s|水平切分当前窗口,新窗口仍显示当前缓冲区|
|<C-w>v|垂直切分当前窗口,新窗口仍显示当前缓冲区|
|:sp[lit] {file}|水平切分当前窗口,并在新窗口中载入{file}|
|:vsp[lit] {file}|垂直切分当前窗口,并在新窗口中载入{file}|

-   切换窗口

|命令|作用|
|:-------------:|:-------------------------------:|
|<C-w>w/<C-w><C-w>|在窗口间循环切换|
|<C-w>h|切换到左边的窗口|
|<C-w>j|切换到下边的窗口|
|<C-w>k|切换到上边的窗口|
|<C-w>l|切换到右边的窗口|

-   自定义窗口

> :h window-moving

|命令|作用|
|:-------------:|:-------------------------------:|
|<C-w>=|使所有窗口等宽、等高|
|<C-w>_|最大化活动窗口的高度|
|<C-w>\||最大化活动窗口的宽度|
|[N]<C-w>_|把活动窗口的高度设为[N]行|
|[N]<C-w>\||把活动窗口的宽度设为[N]列|
|:windo lcd {path}|设置当前标签页的所有窗口的工作目录|

-   关闭窗口

|Ex命令|Normal命令|作用|
|:-------:|:--------:|:-------------------------------:|
|:clo[se]|<C-w>c|关闭活动窗口|
|:on[ly]|<C-w>o|只保留活动窗口,关闭其他所有窗口|

### 标签

-   新建/关闭标签页

|命令|作用|
|:-------------:|:-------------------------------:|
|:tabe[dit] {filename}|在新标签页中打开{filename}|
|<C-w>T|把当前窗口移到一个新标签页|
|:tabc[lose]|关闭当前标签页及其中的所有窗口|
|:tabo[nly]|只保留活动标签页,关闭所有其他标签页|

-   切换标签页

|Ex命令|Normal命令|作用|
|:-------:|:--------:|:-------------------------------:|
|:tabn[ext] {N}|{N}gt|切换到编号为{N} 的标签页|
|:tabn[ext]|gt|切换到下一标签页|
|:tabp[revious]|gT|切换到上一标签页|

-    重排标签页

:tabmove [N] - N为0时,当前标签页移至首;N省略时,至尾

### 文件管理器

|Ex命令|作用
|:-------------:|:-------------------------------:|
|:edit ./:e.|打开文件管理器,并显示当前工作目录|
|:Explore/:E|打开文件管理器,并显示活动缓冲区所在的目录|